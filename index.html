<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>FULLSCREEN AIRHORN</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: red;
  }

  #fullscreenButton {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 60px;
    color: white;
    font-family: Arial, sans-serif;
    cursor: pointer;
    user-select: none;
  }
</style>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

</head>

<body>

<div id="fullscreenButton" onclick="unlockAudio()">
  TAP TO ACTIVATE ðŸ”Š
</div>

<audio id="sound" src="airhorn.mp3"></audio>

<script>

let socket;
let audioUnlocked = false;
const audio = document.getElementById("sound");

// Wird beim ersten Tippen aktiviert (wichtig fÃ¼r iPhone)
function unlockAudio() {
  if (!audioUnlocked) {
    audio.play().then(() => {
      audio.pause();
      audio.currentTime = 0;
      audioUnlocked = true;
      connectSocket();
      document.getElementById("fullscreenButton").innerText = "READY ðŸš€";
    });
  }
}

function connectSocket() {
  socket = io("https://telegram-horn-remote.onrender.com");

  socket.on("connect", () => {
    console.log("Mit Server verbunden");
  });

  socket.on("horn_signal", () => {
    if (audioUnlocked) {
      audio.loop = true;
      audio.currentTime = 0;
      audio.play();
    }
  });
}

</script>

</body>
</html>
